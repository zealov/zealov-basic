"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[748],{7643:(e,t,a)=>{a.d(t,{Kz:()=>i,h:()=>l,$Z:()=>o,Vx:()=>s});var r=a(4319);function i(e){return(0,r.Z)({url:"/blog/file",method:"get",params:e})}function l(e){return(0,r.Z)({url:"/blog/file",method:"post",data:e})}function o(e){return(0,r.Z)({url:"/blog/file/"+e,method:"get"})}function s(e,t){return(0,r.Z)({url:"/blog/file/"+e,method:"put",data:t})}},6748:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var r=a(7643),i=a(113),l=a(1203),o=a(5108);const s={data:function(){return{loadingTable:!1,total:0,offset:1,limit:10,total_pages:5,expandedKeys:[],draggable:!1,headers:{},action:"",uploadData:{},createFileVisible:!1,updateFileVisible:!1,loading:!1,tableData:[],createLoading:!1,updateLoading:!1,createError:{},updateError:{},imageUrlPreview:"",editImageUrlPreview:"",createFileForm:{name:"",path:"",redirect:"",description:"",published:!0,sort:0},updateFileForm:{id:"",name:"",path:"",redirect:"",description:"",published:!0,sort:""}}},mounted:function(){this.setAction(),this.getList(),this.setHeader()},methods:{toFormatSize:function(e){return(0,l.BU)(e)},complete:function(e){return(0,l.UO)()+e},handleEdit:function(e){var t=this;o.log(e),this.updateError={},(0,r.$Z)(e.id).then((function(e){var a=e.data;t.updateFileVisible=!0,t.updateFileForm=a,t.updateLoading=!1,t.editImageUrlPreview=(0,l.UO)()+a.path}))},getList:function(){var e=this,t={offset:this.offset,limit:this.limit,order:"descending"};(0,r.Kz)(t).then((function(t){e.tableData=t.data.data,e.total=t.data.total}))},createFile:function(e){var t=this;this.createLoading=!0,this.createError={},(0,r.h)(this.createFileForm).then((function(a){t.$message({message:a.message,type:"success"}),t.resetCreateForm(e),t.createFileVisible=!1,t.getList()})).catch((function(e){var a=e.data;422===e.code&&(t.createError=a)})).finally((function(){t.createLoading=!1}))},resetCreateForm:function(e){this.$refs[e].resetFields()},updateFile:function(){var e=this;this.updateError={},this.updateLoading=!0,(0,r.Vx)(this.updateFileForm.id,this.updateFileForm).then((function(t){e.$message({message:t.message,type:"success"}),e.updateFileVisible=!1,e.getList()})).catch((function(t){var a=t.data;422===t.code&&(e.updateError=a)})).finally((function(){e.updateLoading=!1}))},setHeader:function(){this.headers={Authorization:"Bearer "+(0,i.LP)()}},setAction:function(){this.action=(0,l.Vy)()+"/blog/file/upload"},successUpload:function(e,t,a){this.imageUrlPreview=(0,l.UO)()+e.data.path,this.createFileForm.size=t.size,this.createFileForm.path=e.data.path},beforeUpload:function(e){this.uploadData.directory="/file",this.createFileForm.name=e.name},successUploadEdit:function(e,t,a){this.editImageUrlPreview="",this.editImageUrlPreview=(0,l.UO)()+e.data.path,this.updateFileForm.size=t.size,this.updateFileForm.path=e.data.path},beforeUploadEdit:function(e){this.uploadData.directory="/file",this.updateFileForm.name=e.name},handleSizeChange:function(e){this.offset=e,this.getList()},handleCurrentChange:function(e){this.offset=e,this.getList()}}};const n=(0,a(1900).Z)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content_container"},[a("el-scrollbar",[a("div",{staticClass:"container",staticStyle:{"padding-top":"0"}},[a("div",{staticClass:"header_container is-sticky-top"},[a("div",{staticClass:"left"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.createFileVisible=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加文件\n                    ")])],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticClass:"table-list"},[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"id","show-overflow-tooltip":!0,width:"100",align:"center",label:"ID"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"缩略图",prop:"path",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[e.row.path?a("img",{staticClass:"thumbImg",attrs:{src:e.row.path}}):a("img",{staticClass:"thumbImg",attrs:{src:"images/demo.jpg"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,"min-width":"40%",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{href:e.complete(t.row.path),target:"_blank",type:"primary"}},[e._v("\n                            "+e._s(t.row.name)+"\n                        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,label:"大小",prop:"size","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(e.toFormatSize(t.row.size))+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at","show-overflow-tooltip":!0,sortable:"","min-width":"90",align:"center",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"label","show-overflow-tooltip":!0,align:"center","min-width":"90",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.published?a("el-tag",{staticStyle:{margin:"0 3px"},attrs:{type:"success",size:"small"}},[e._v("已发布")]):a("el-tag",{staticStyle:{margin:"0 3px"},attrs:{type:"info",size:"small"}},[e._v("未发布")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(a){return e.handleEdit(t.row)}}},[a("i",{staticClass:"el-icon-edit"})])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"footer_container is-sticky-bottom"},[a("el-pagination",{attrs:{"current-page":e.offset,"pager-count":e.total_pages,"page-size":e.limit,layout:"total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),e._v(" "),a("el-dialog",{attrs:{"custom-class":"dialog_tc",title:"添加",visible:e.createFileVisible,width:"560px","close-on-click-modal":!1},on:{"update:visible":function(t){e.createFileVisible=t}}},[a("el-form",{ref:"createForm",attrs:{model:e.createFileForm,"label-width":"80px",size:"medium"}},[a("el-form-item",{staticClass:"upload_thumb",attrs:{label:"图片",prop:"path"}},[a("el-upload",{staticClass:"uploadThumbImg",attrs:{headers:e.headers,action:e.action,"show-file-list":!1,"on-success":e.successUpload,"before-upload":e.beforeUpload,data:e.uploadData}},[e.createFileForm.path?a("img",{staticClass:"thumb",attrs:{src:e.imageUrlPreview}}):a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{staticClass:"el-upload__tip"},[e._v("\n                    支持JPG/PNG格式，\n                    "),a("br"),e._v("图片大小不超过10MB\n                ")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"名称",required:"",error:e.createError.name?e.createError.name[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入导航名称"},model:{value:e.createFileForm.name,callback:function(t){e.$set(e.createFileForm,"name",t)},expression:"createFileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"description",label:"简介",error:e.createError.description?e.createError.description[0]:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入简介",maxlength:"500","show-word-limit":"",rows:3},model:{value:e.createFileForm.description,callback:function(t){e.$set(e.createFileForm,"description",t)},expression:"createFileForm.description"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"url",label:"导航网址",error:e.createError.url?e.createError.url[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"例：www.zealov.com"},model:{value:e.createFileForm.url,callback:function(t){e.$set(e.createFileForm,"url",t)},expression:"createFileForm.url"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"published",label:"状态",error:e.createError.published?e.createError.published[0]:""}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.createFileForm.published,callback:function(t){e.$set(e.createFileForm,"published",t)},expression:"createFileForm.published"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createFileVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.createLoading},on:{click:function(t){return e.createFile("createForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{"custom-class":"dialog_tc",title:"修改",visible:e.updateFileVisible,width:"560px","close-on-click-modal":!1},on:{"update:visible":function(t){e.updateFileVisible=t}}},[a("el-form",{ref:"updateForm",attrs:{model:e.updateFileForm,"label-width":"80px",size:"medium"}},[a("el-form-item",{staticClass:"upload_thumb",attrs:{label:"缩略图",prop:"path"}},[a("el-upload",{staticClass:"uploadThumbImg",attrs:{headers:e.headers,action:e.action,"show-file-list":!1,"on-success":e.successUploadEdit,"before-upload":e.beforeUploadEdit,data:e.uploadData}},[e.updateFileForm.path?a("img",{staticClass:"thumb",attrs:{src:e.editImageUrlPreview}}):a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{staticClass:"el-upload__tip"},[e._v("\n                    支持JPG/PNG格式\n                    "),a("br"),e._v("图片大小不超过10MB\n                ")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"名称",required:"",error:e.updateError.name?e.updateError.name[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入导航名称"},model:{value:e.updateFileForm.name,callback:function(t){e.$set(e.updateFileForm,"name",t)},expression:"updateFileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"redirect",label:"导航地址",error:e.updateError.redirect?e.updateError.redirect[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入地址"},model:{value:e.updateFileForm.redirect,callback:function(t){e.$set(e.updateFileForm,"redirect",t)},expression:"updateFileForm.redirect"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"description",label:"简介",error:e.updateError.description?e.updateError.description[0]:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入简介",maxlength:"500","show-word-limit":"",rows:3},model:{value:e.updateFileForm.description,callback:function(t){e.$set(e.updateFileForm,"description",t)},expression:"updateFileForm.description"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"published",label:"状态",error:e.updateError.published?e.updateError.published[0]:""}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.updateFileForm.published,callback:function(t){e.$set(e.updateFileForm,"published",t)},expression:"updateFileForm.published"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateFileVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.updateLoading},on:{click:function(t){return e.updateFile("updateForm")}}},[e._v("保存")])],1)],1)],1)}),[],!1,null,null,null).exports}}]);