"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[508],{7040:(t,e,a)=>{a.d(e,{K:()=>l,V:()=>s});var i=a(5814);function l(t){return(0,i.Z)({url:"/form/index",method:"get",params:t})}function s(t,e){return(0,i.Z)({url:"/form/"+t,method:"put",data:e})}},9508:(t,e,a)=>{a.r(e),a.d(e,{default:()=>c});var i=a(7040),l=a(8276),s=a(5108),n=a(4155);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const r={layout:"basic",middleware:["auth"],data:function(){return{loading:!1,file_path_list:[],form:{id:"",name:"",age:"",injection_metering:"",is_contraception:"",status:"",reason:"",visit_at:"",file_path:"",created_at:""},statusOptions:[{value:"1",label:"待审核"},{value:"2",label:"通过"},{value:"3",label:"驳回"}],filter:{keyWords:"",status:""},total:0,offset:1,limit:10,total_pages:5,tableLoading:!0,tableData:[],dialog:!1,formLabelWidth:"120px",timer:null,role:""}},mounted:function(){this.role=(0,l.c)(),this.getList()},methods:{submit:function(){var t=this;this.loading||this.$confirm("确定要提交表单吗？").then((function(e){t.loading=!0,t.timer=setTimeout((function(){(0,i.V)(t.form.id,t.form).then((function(e){setTimeout((function(){t.loading=!1}),400),t.dialog=!1,t.getList()}))}),1e3)})).catch((function(t){}))},cancelForm:function(){this.loading=!1,this.dialog=!1,clearTimeout(this.timer)},dialogReview:function(t){this.form.id=t.id,this.form.name=t.name,this.form.age=t.age,this.form.injection_metering=t.injection_metering,this.form.is_contraception=t.is_contraception,this.form.status=t.status,this.form.reason=t.reason,this.form.visit_at=t.visit_at,this.form.created_at=t.created_at,this.form.file_path=t.app_url+t.file_path,this.file_path_list.push(t.app_url+t.file_path),this.dialog=!0},search:function(){s.log(this.filter),s.log(123),this.getList()},getList:function(){var t=this;s.log(o(this.filter));var e={offset:this.offset,limit:this.limit,order:"descending",keyWords:this.filter.keyWords,status:this.filter.status};s.log(e),(0,i.K)(e).then((function(e){t.tableData=e.data.list,t.total=e.data.total,t.tableLoading=!1})).catch((function(e){t.tableLoading=!1}))},handleSizeChange:function(t){this.limit=t,this.getList()},handleCurrentChange:function(t){this.offset=t,this.getList()},download:function(){var t,e,a=null!==(t=this.filter.date[0])&&void 0!==t?t:"",i=null!==(e=this.filter.date[1])&&void 0!==e?e:"";s.log("&start_date="+a+"&end_date="+i),window.open(n.env.MIX_VUE_APP_BASE_API+"/form/downloadForm?token"+(0,l.L)()+"&start_date="+a+"&end_date="+i,"_blank")}}};const c=(0,a(1900).Z)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content_container"},[a("el-scrollbar",[a("div",{staticClass:"container",staticStyle:{"padding-top":"0"}},[a("div",{staticClass:"header_container is-sticky-top"},[a("div",{staticClass:"left"}),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"filter"},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},t._l(t.statusOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入姓名",clearable:""},model:{value:t.filter.keyWords,callback:function(e){t.$set(t.filter,"keyWords",e)},expression:"filter.keyWords"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.search()}}},[a("i",{staticClass:"el-icon-search"})])],1)],1)],1)])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"table-list"},[a("el-table",{attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"姓名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hospital",align:"center",label:"医院"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n                  "+t._s(null!=e.row.doctor.hospital?e.row.doctor.hospital:"")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"age",label:"年龄",align:"center",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"injection_metering",align:"center",label:"注射计量（ml）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"is_contraception",align:"center",label:"是否为人工流产后避孕"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",align:"center",label:"审核状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("div",[a("el-tag",[t._v("待审核")])],1):2==e.row.status?a("div",[a("el-tag",{attrs:{type:"success"}},[t._v("\n                    通过\n                  ")])],1):3==e.row.status?a("div",[a("el-tag",{attrs:{type:"danger"}},[t._v("\n                    驳回\n                  ")])],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"visit_at",align:"center",label:"就诊时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",align:"center",label:"提交时间"}}),t._v(" "),t.role.includes("manager")?a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-check"},on:{click:function(a){return t.dialogReview(e.row)}}},[t._v("\n                    审核\n                  ")])],1)]}}],null,!1,4213868490)}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"footer_container is-sticky-bottom"},[a("el-pagination",{attrs:{"current-page":t.offset,"pager-count":t.total_pages,"page-size":t.limit,layout:"total, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("el-drawer",{ref:"drawer",attrs:{title:"",visible:t.dialog,direction:"rtl","custom-class":"custom-drawer"},on:{"update:visible":function(e){t.dialog=e}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"处方签详情",column:2,border:""}},[a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-user"}),t._v("\n                姓名\n              ")]),t._v("\n              "+t._s(t.form.name)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-view"}),t._v("\n                年龄\n              ")]),t._v("\n              "+t._s(t.form.age)+"\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-coffee"}),t._v("\n                注释计量\n              ")]),t._v("\n              "+t._s(t.form.injection_metering)+"ml\n            ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-tickets"}),t._v("\n                患者是否为人工流产后避孕：\n              ")]),t._v(" "),a("el-tag",{attrs:{size:"small"}},[t._v(t._s(t.form.is_contraception))])],2),t._v(" "),a("el-descriptions-item",{attrs:{span:2}},[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                就诊时间\n              ")]),t._v("\n              "+t._s(t.form.visit_at)+"\n            ")],2),t._v(" "),a("el-descriptions-item",{attrs:{span:2}},[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                提交时间\n              ")]),t._v("\n              "+t._s(t.form.created_at)+"\n            ")],2),t._v(" "),a("el-descriptions-item",{attrs:{span:2}},[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-office-building"}),t._v("\n                处方签\n              ")]),t._v(" "),a("div",{staticClass:"demo-image__preview"},[a("el-image",{staticStyle:{width:"200px",height:"auto"},attrs:{src:t.form.file_path,"preview-src-list":t.file_path_list}})],1)],2)],1),t._v(" "),a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"审核状态","label-width":t.formLabelWidth,required:""}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[t._v("\n                  待审核\n                ")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("\n                  通过\n                ")]),t._v(" "),a("el-radio",{attrs:{label:3}},[t._v("\n                  驳回\n                ")])],1)],1),t._v(" "),3==t.form.status?a("el-form-item",{attrs:{label:"驳回原因","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1):t._e()],1),t._v(" "),a("div",{staticClass:"demo-drawer__footer"},[a("el-button",{on:{click:t.cancelForm}},[t._v("\n              取 消\n            ")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("\n              "+t._s(t.loading?"提交中 ...":"提 交")+"\n            ")])],1)],1)])],1)],1)}),[],!1,null,null,null).exports}}]);